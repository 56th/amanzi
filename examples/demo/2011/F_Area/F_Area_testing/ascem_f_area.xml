 <!--
This is the input file for the direct problem of flow using Richards equation for the ASCEM-F-Area. 
The domain is represented by 3D cross section. 
It is working with the new standalone simulator amanzi 
-->

<ParameterList name="Main">

<!-- 
 <Parameter name="Amanzi input format version" type="string" value="0.9.0"/>

If Amanzi input format version is specified for both cases (0.9.0 or 1.0.0)  the following message are 
provided

"terminate called after throwing an instance of 'Teuchos::Exceptions::InvalidParameterName'
  what():  Error, the sublist ANONYMOUS->"Rock" does not exist!"

On the other hand, "Amanzi Input Format Version"  as is shown in /doc/input_spec/ is not recognized by
the current version of Amanzi. 


-->   
 <Parameter name="Native Unstructured Input" type="bool" value="true"/> 
 <Parameter name="grid_option" type="string" value="Unstructured"/> -->


 <ParameterList name="Documentation">
    <Parameter name="Direct Simulation (flow)" type="string" value="Steady-state flow simulation using Richards equation"/>
    <Parameter name="Spatial Dimension" type="string" value="3"/>
    <Parameter name="Domain Shape" type="string" value="approx. 1400x90x1 m"/>
    <Parameter name="Author" type="string" value="S. A. Bea"/>
  </ParameterList>


 <ParameterList name="Mesh">
    <Parameter name="Mesh Class" type="string" value="STK"/> 
    <Parameter name="Framework" type="string" value="stk::mesh" />
    <Parameter name="Read"  type="string" value="ascem_f_area_mesh.exo"/> 
<Parameter name="Read"  type="string" value="ascem_f_area_mesh.exo"/> 
   "Format" [string] Format in which mesh is stored in file
  </ParameterList>


 <ParameterList name="MPC">
    <Parameter name="Start Time" type="double" value="0.0"/>
    <Parameter name="End Time" type="double" value="3.1536e10"/>
    <Parameter name="End Cycle" type="int" value="5000"/>
    <Parameter name="disable Flow_PK" type="string" value="no"/> <!-- For now only flow -->
    <Parameter name="Flow model" type="string" value="Richards"/> 
    <Parameter name="disable Transport_PK" type="string" value="yes"/>
    <Parameter name="disable Chemistry_PK" type="string" value="yes"/>  
  </ParameterList> 
 <!-- 
Is not clear if visualization is workin properly. For instance, Why I need to specify 
File Name Base if it is not used in the current version of Amanzi?
On the other hand,  "Visualization Data" as is shown in /doc/input_spec/ is not recognized by
the current version of Amanzi. 
-->
<ParameterList name="Visualization">
  <Parameter name="File Name Base" type="string" value="output"/>
  <Parameter name="File Name Digits" type="int" value="6"/>
  <ParameterList name="Cycle Data">
    <Parameter name="Start" type="int" value="0"/>
    <Parameter name="End" type="int" value="-1"/>
    <Parameter name="Interval" type="int" value="1"/>
  </ParameterList>
</ParameterList>



  <ParameterList name="State">
    <Parameter name="Number of mesh blocks" type="int" value="5"/>
    <Parameter name="Number of component concentrations" type="int" value="1"/>
    <Parameter name="Constant water saturation" type="double" value="1.0"/> <!-- What is the meaning of this?? -->
    <Parameter name="Constant water density" type="double" value="1000.0"/>
    <Parameter name="Constant viscosity" type="double" value="0.001"/>  
    <Parameter name="Gravity x" type="double" value="0.0"/>
    <Parameter name="Gravity y" type="double" value="0.0"/>
    <Parameter name="Gravity z" type="double" value="-9.806"/>

    <!-- Upper aquifer + vadose zone -->
    <ParameterList name="Mesh block 1"> 
      <Parameter name="Mesh block ID" type="int" value="50000"/>
      <Parameter name="Constant porosity" type="double" value="0.39"/>
      <Parameter name="Constant permeability" type="double" value="1.0e-11"/>
      <Parameter name="Constant component concentration 0" type="double" value="1.e-5"/>
    </ParameterList>

    <!-- Lower aquifer -->
    <ParameterList name="Mesh block 2"> 
      <Parameter name="Mesh block ID" type="int" value="30000"/>
      <Parameter name="Constant porosity" type="double" value="0.2"/>
      <Parameter name="Constant permeability" type="double" value="1.0e-11"/>
      <Parameter name="Constant component concentration 0" type="double" value="1.e-5"/>
    </ParameterList>

    <!-- Tan clay unit -->
    <ParameterList name="Mesh block 3"> 
      <Parameter name="Mesh block ID" type="int" value="40000"/>
      <Parameter name="Constant porosity" type="double" value="0.3"/>
      <Parameter name="Constant permeability" type="double" value="1.0e-11"/>
      <Parameter name="Constant component concentration 0" type="double" value="1.e-5"/>
    </ParameterList>

    <!-- Gordon aquifer -->
    <ParameterList name="Mesh block 4"> 
      <Parameter name="Mesh block ID" type="int" value="20000"/>
      <Parameter name="Constant porosity" type="double" value="0.4"/>
      <Parameter name="Constant permeability" type="double" value="1.0e-11"/>
      <Parameter name="Constant component concentration 0" type="double" value="1.e-5"/>
    </ParameterList>

   <!-- F-3 Basin -->
    <ParameterList name="Mesh block 5"> 
      <Parameter name="Mesh block ID" type="int" value="70000"/>
      <Parameter name="Constant porosity" type="double" value="0.4"/>
      <Parameter name="Constant permeability" type="double" value="1.0e-11"/>
      <Parameter name="Constant component concentration 0" type="double" value="1.e-5"/>
    </ParameterList>
  
</ParameterList>


  <ParameterList name="Flow">

    <ParameterList name="Richards Problem">

<!--  
Set the initial conditions for flow as 

p = p_atmospheric - 9.8 * rho * (z - height) 

Note that based on "estimated" position of the water table (see mesh_general_ascem_PHASE_I.pdf),
the water table are located z=65 m. Thus, up the water table, the P<Patm. 
 -->
      <Parameter name="Steady state calculation initial time" type="double" value="0.0"/>
      <Parameter name="Steady state calculation final time" type="double" value="3.1536e9"/>
      <Parameter name="Steady state calculation initial time step" type="double" value="1.0e-7"/>
      <Parameter name="Steady state calculation initial hydrostatic pressure height" type ="double" value="65.0"/>

      <Parameter name="Atmospheric pressure" type="double" value="101325.0"/> <!-- [Pa]  => [Kg m-1 s-2] -->
      
      <ParameterList name="Richards model evaluator">
        <Parameter name="Absolute error tolerance" type="double" value="1.0"/>
        <Parameter name="Relative error tolerance" type="double" value="1.0e-5"/>
        <ParameterList name="VerboseObject">
	  <Parameter name="Verbosity Level" type="string" value="none"/>
	</ParameterList>       
      </ParameterList>
<!--
      <ParameterList name="Time integrator">
        <Parameter name="Nonlinear solver max iterations" type="int" value="6"/>
	<Parameter name="Nonlinear solver tolerance" type="double" value="0.01"/>
        <Parameter name="NKA max vectors" type="int" value="5"/>
	<Parameter name="NKA drop tolerance" type="double" value="5.0e-2"/>
	<Parameter name="Maximum number of BDF tries" type="int" value="10"/>
        <ParameterList name="VerboseObject">
	  <Parameter name="Verbosity Level" type="string" value="medium"/>
	</ParameterList>
      </ParameterList>	
-->
      <ParameterList name="Water retention models">
	<!-- Upper Aquifer -->
        <ParameterList name="Water retention model 1">
          <Parameter name="Water retention model" type="string" value="van Genuchten"/>
          <Parameter name="Region ID" type="int" value="50000"/>
          <Parameter name="van Genuchten m" type="double" value="0.39"/>
          <Parameter name="van Genuchten alpha" type="double" value="6.33e-5"/>
          <Parameter name="van Genuchten residual saturation" type="double" value="0.0609"/>
        </ParameterList>

	<!-- Lower Aquifer -->
        <ParameterList name="Water retention model 2">
          <Parameter name="Water retention model" type="string" value="van Genuchten"/>
          <Parameter name="Region ID" type="int" value="30000"/>
          <Parameter name="van Genuchten m" type="double" value="0.39"/>
          <Parameter name="van Genuchten alpha" type="double" value="6.33e-5"/>
          <Parameter name="van Genuchten residual saturation" type="double" value="0.0609"/>
        </ParameterList>

	<!-- Tan Clay Unit -->
        <ParameterList name="Water retention model 3">
          <Parameter name="Water retention model" type="string" value="van Genuchten"/>
          <Parameter name="Region ID" type="int" value="40000"/>
          <Parameter name="van Genuchten m" type="double" value="0.39"/>
          <Parameter name="van Genuchten alpha" type="double" value="6.33e-5"/>
          <Parameter name="van Genuchten residual saturation" type="double" value="0.0609"/>
        </ParameterList>

	<!-- Gordon Aquifer -->
        <ParameterList name="Water retention model 4">
          <Parameter name="Water retention model" type="string" value="van Genuchten"/>
          <Parameter name="Region ID" type="int" value="20000"/>
          <Parameter name="van Genuchten m" type="double" value="0.39"/>
          <Parameter name="van Genuchten alpha" type="double" value="6.33e-5"/>
          <Parameter name="van Genuchten residual saturation" type="double" value="0.0609"/>
        </ParameterList>

	<!-- Basin -->
        <ParameterList name="Water retention model 4">
          <Parameter name="Water retention model" type="string" value="van Genuchten"/>
          <Parameter name="Region ID" type="int" value="70000"/>
          <Parameter name="van Genuchten m" type="double" value="0.39"/>
          <Parameter name="van Genuchten alpha" type="double" value="6.33e-5"/>
          <Parameter name="van Genuchten residual saturation" type="double" value="0.0609"/>
        </ParameterList>



      </ParameterList>

      <ParameterList name="Diffusion Preconditioner">
	<ParameterList name="ML Parameters">
	  <Parameter name="ML output" type="int" value="1"/>
  	  <Parameter name="max levels" type="int" value="40"/>
	  <Parameter name="prec type" type="string" value="MGW"/>
	  <Parameter name="cycle applications" type="int" value="2"/>
	  <Parameter name="aggregation: type" type="string" value="Uncoupled"/> 
	  <Parameter name="aggregation: damping factor" type="double" value="1.333"/>
	  <Parameter name="aggregation: threshold" type="double" value="0.0"/>
	  <Parameter name="aggregation: nodes per aggregate" type="int" value="3"/>
	  <Parameter name="eigen-analysis: type" type="string" value="cg"/>
	  <Parameter name="eigen-analysis: iterations" type="int" value="10"/>
	  <Parameter name="smoother: sweeps" type="int" value="2"/>
	  <Parameter name="smoother: damping factor" type="double" value="1.0"/>
	  <Parameter name="smoother: pre or post" type="string" value="both"/>
	  <Parameter name="smoother: type" type="string" value="Gauss-Seidel"/>
	  <Parameter name="smoother: damping factor" type="double" value="1.0"/>
	  <Parameter name="coarse: type" type="string" value="Gauss-Seidel"/>
          <Parameter name="coarse: max size" type="int" value="5"/>	   
          <Parameter name="coarse: sweeps" type="int" value="5"/>	   
          <Parameter name="coarse: damping factor" type="double" value="1.0"/>	   
	</ParameterList>
      </ParameterList>
    </ParameterList>
<!--  
Boundary conditions  

p = p_atmospheric - 9.8 * rho * (z - height) 
 -->
    <ParameterList name="Flow BC">
      <Parameter name="number of BCs" type="int" value="9"/>
      <!-- Seepage BC -->
      <ParameterList name="BC00">
	<Parameter name="Type" type="string" value="No Flow"/>
	<Parameter name="BC value" type="double" value="0.0" />
	<Parameter name="Side set ID" type="int" value="1" />
      </ParameterList>
     <!-- Upper BC (left) -->
      <ParameterList name="BC01">
	<Parameter name="Type" type="string" value="No Flow"/>
	<Parameter name="BC value" type="double" value="0.0" />
	<Parameter name="Side set ID" type="int" value="2" />
      </ParameterList>    
     <!-- F3 Basin BC -->  
      <ParameterList name="BC02">
	<Parameter name="Type" type="string" value="No Flow"/>
	<Parameter name="BC value" type="double" value="0.0" />
	<Parameter name="Side set ID" type="int" value="3" />
      </ParameterList>
      <!-- Upper BC (right) -->
      <ParameterList name="BC03">
	<Parameter name="Type" type="string" value="No Flow"/>
	<Parameter name="BC value" type="double" value="0.0" />
	<Parameter name="Side set ID" type="int" value="4" />
      </ParameterList> 
      <!-- Unsaturated zone BC (right) -->
      <ParameterList name="BC04">
	<Parameter name="Type" type="string" value="No Flow"/>
	<Parameter name="BC value" type="double" value="0.0" />
	<Parameter name="Side set ID" type="int" value="5" />
      </ParameterList> 
      <!-- Saturated zone BC (right) -->
      <ParameterList name="BC05">
	<Parameter name="Type" type="string" value="Static Head"/>
	<Parameter name="BC value" type="double" value="65.0" />
	<Parameter name="Side set ID" type="int" value="6" />
      </ParameterList> 
      <!-- Gordon Aquifer BC (right) -->
      <ParameterList name="BC06">
	<Parameter name="Type" type="string" value="No Flow"/>
	<Parameter name="BC value" type="double" value="0.0" />
	<Parameter name="Side set ID" type="int" value="7" />
      </ParameterList> 
      <!-- Gordon Aquifer BC (left) -->
      <ParameterList name="BC07">
	<Parameter name="Type" type="string" value="No Flow"/>
	<Parameter name="BC value" type="double" value="0.0" />
	<Parameter name="Side set ID" type="int" value="8" />
      </ParameterList> 
      <!-- Saturated zone BC (left) -->
      <ParameterList name="BC08">
	<Parameter name="Type" type="string" value="Static Head"/>
	<Parameter name="BC value" type="double" value="55.0" />  
	<Parameter name="Side set ID" type="int" value="9" />
      </ParameterList> 
  </ParameterList>



  </ParameterList>

</ParameterList>
