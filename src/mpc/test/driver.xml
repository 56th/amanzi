<ParameterList name="Main">
  <Parameter name="Native Unstructured Input" type="bool" value="true"/>
  <Parameter name="grid_option" type="string" value="Unstructured"/>


  <!-- This is a special list specifically designed for this test -->
  <!-- It does not conform to the Amanzi input specification      -->

  <ParameterList name="Mesh">
    <Parameter name="Mesh Class" type="string" value="MSTK"/>
    <ParameterList name="MSTK Mesh Parameters">
      <Parameter name="Exodus file name" type="string" value="test/mesh.exo"/>
    </ParameterList>   
  </ParameterList>

  <!-- End special list -->


  <ParameterList name="Regions">
    <ParameterList name="All">
      <ParameterList name="Region: Box">
	<Parameter name="Low Coordinate" type="Array(double)" value="{0.0, 0.0, 0.0}"/>
	<Parameter name="High Coordinate" type="Array(double)" value="{1.0, 1.0, 1.0}"/>
      </ParameterList>
    </ParameterList>
    
    <ParameterList name="SS0">
      <ParameterList name="Region: Labeled Set">
	<Parameter name="Label" type="string" value="1"/>
	<Parameter name="File" type="string" value="mesh.exo"/>
	<Parameter name="Format" type="string" value="Exodus II"/>
	<Parameter name="Entity" type="string" value="Face"/>
      </ParameterList>
    </ParameterList>
	
    <ParameterList name="SS1">
      <ParameterList name="Region: Labeled Set">
	<Parameter name="Label" type="string" value="2"/>
	<Parameter name="File" type="string" value="mesh.exo"/>
	<Parameter name="Format" type="string" value="Exodus II"/>
	<Parameter name="Entity" type="string" value="Face"/>
      </ParameterList>
    </ParameterList>
	
    <ParameterList name="SS2">
      <ParameterList name="Region: Labeled Set">
	<Parameter name="Label" type="string" value="3"/>
	<Parameter name="File" type="string" value="mesh.exo"/>
	<Parameter name="Format" type="string" value="Exodus II"/>
	<Parameter name="Entity" type="string" value="Face"/>
      </ParameterList>
    </ParameterList>
	
    <ParameterList name="SS3">
      <ParameterList name="Region: Labeled Set">
	<Parameter name="Label" type="string" value="4"/>
	<Parameter name="File" type="string" value="mesh.exo"/>
	<Parameter name="Format" type="string" value="Exodus II"/>
	<Parameter name="Entity" type="string" value="Face"/>
      </ParameterList>
    </ParameterList>
	
    <ParameterList name="SS4">
      <ParameterList name="Region: Labeled Set">
	<Parameter name="Label" type="string" value="5"/>
	<Parameter name="File" type="string" value="mesh.exo"/>
	<Parameter name="Format" type="string" value="Exodus II"/>
	<Parameter name="Entity" type="string" value="Face"/>
      </ParameterList>
    </ParameterList>
	
    <ParameterList name="SS5">
      <ParameterList name="Region: Labeled Set">
	<Parameter name="Label" type="string" value="6"/>
	<Parameter name="File" type="string" value="mesh.exo"/>
	<Parameter name="Format" type="string" value="Exodus II"/>
	<Parameter name="Entity" type="string" value="Face"/>
      </ParameterList>
    </ParameterList>
  </ParameterList> <!-- End Regions -->


  <ParameterList name="MPC">
    <ParameterList name="Time Integration Mode">
      <ParameterList name="Steady">
	<Parameter name="Start" type="double" value="0.0"/>
	<Parameter name="End" type="double" value="0.0"/>   
	<Parameter name="Initial Time Step" type="double" value="1000"/>
      </ParameterList>
    </ParameterList>
    <Parameter name="Chemistry Model" type="string" value="Amanzi"/>
    <Parameter name="disable Flow_PK" type="string" value="no"/>
    <Parameter name="Flow model" type="string" value="Darcy"/>
    <ParameterList name="GMV">
      <Parameter name="Mesh file name" type="string" value="test_driver_mesh.gmv"/>
      <Parameter name="Data file name" type="string" value="test_driver_data.gmv"/>
      <Parameter name="Dump cycle frequency" type="int" value="1000"/>
    </ParameterList>    
    <Parameter name="component names" type="Array(string)" value="{A, B, C, D, E}" />
  </ParameterList> <!-- End MPC -->

  <ParameterList name="Solvers">
    <ParameterList name="AztecOO CG">
      <Parameter name="preconditioner" type="string" value="Trilinos ML"/>
      <Parameter name="iterative method" type="string" value="gmres"/>
      <ParameterList name="gmres parameters">
        <Parameter name="maximal number of iterations" type="int" value="400"/>
        <Parameter name="error tolerance" type="double" value="1e-12"/>
      </ParameterList>
    </ParameterList>
  </ParameterList>  <!-- End Solvers -->

  <ParameterList name="Preconditioners">
    <ParameterList name="Trilinos ML">
      <Parameter name="preconditioner type" type="string" value="ml"/>
      <ParameterList name="ML Parameters">
        <Parameter name="ML output" type="int" value="0"/>
        <Parameter name="aggregation: damping factor" type="double" value="1.33"/>
        <Parameter name="aggregation: nodes per aggregate" type="int" value="3"/>
        <Parameter name="aggregation: threshold" type="double" value="0"/>
        <Parameter name="aggregation: type" type="string" value="Uncoupled"/>
        <Parameter name="coarse: max size" type="int" value="128"/>
        <Parameter name="coarse: type" type="string" value="Amesos-KLU"/>
        <Parameter name="cycle applications" type="int" value="2"/>
        <Parameter name="eigen-analysis: iterations" type="int" value="10"/>
        <Parameter name="eigen-analysis: type" type="string" value="cg"/>
        <Parameter name="max levels" type="int" value="40"/>
        <Parameter name="prec type" type="string" value="MGW"/>
        <Parameter name="smoother: damping factor" type="double" value="1"/>
        <Parameter name="smoother: pre or post" type="string" value="both"/>
        <Parameter name="smoother: sweeps" type="int" value="2"/>
        <Parameter name="smoother: type" type="string" value="Gauss-Seidel"/>
      </ParameterList>
    </ParameterList>
  </ParameterList> <!-- End Preconditioners -->
  
  <ParameterList name="State">
    <ParameterList name="mesh partitions">
      <ParameterList name="materials">
        <Parameter name="region list" type="Array(string)" value="{All}"/>
      </ParameterList>
    </ParameterList>

    <ParameterList name="initial conditions">
      <ParameterList name="fluid_density">
        <Parameter name="value" type="double" value="1000."/>
      </ParameterList>

      <ParameterList name="fluid_viscosity">
        <Parameter name="value" type="double" value="1.00000000000000002e-03"/>
      </ParameterList>
    
      <ParameterList name="gravity">
        <Parameter name="value" type="Array(double)" value="{0.0, 0.0, -9.80664999999999942e+00}"/>
      </ParameterList>

       <ParameterList name="water_density">
        <ParameterList name="function">
          <ParameterList name="All">
            <Parameter name="region" type="string" value="All"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-constant"> <!-- time component -->
                <Parameter name="value" type="double" value="1000.0"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
      </ParameterList>     

      <ParameterList name="permeability">
        <ParameterList name="function">
          <ParameterList name="domain">
            <Parameter name="region" type="string" value="All"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <Parameter name="Number of DoFs" type="int" value="2"/>
              <Parameter name="Function type" type="string" value="composite function"/>
              <ParameterList name="DoF 1 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="1.94000000000000006e-13"/>
                </ParameterList>
              </ParameterList>
              <ParameterList name="DoF 2 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="1.94000000000000006e-13"/>
                </ParameterList>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
      </ParameterList>

      <ParameterList name="pressure">
        <ParameterList name="function">
          <ParameterList name="All">
            <Parameter name="region" type="string" value="All"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-constant"> <!-- time component -->
                <Parameter name="value" type="double" value="0.0"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
      </ParameterList>

      <ParameterList name="porosity">
        <ParameterList name="function">
          <ParameterList name="All">
            <Parameter name="region" type="string" value="All"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-constant"> <!-- time component -->
                <Parameter name="value" type="double" value="0.2"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
      </ParameterList>
      
      <ParameterList name="total_component_concentration">
        <ParameterList name="function">
          <ParameterList name="domain">
            <Parameter name="region" type="string" value="All"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <Parameter name="Number of DoFs" type="int" value="5"/>
              <Parameter name="Function type" type="string" value="composite function"/>
              <ParameterList name="DoF 1 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="0.0"/>
                </ParameterList>
              </ParameterList>
              <ParameterList name="DoF 2 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="0.0"/>
                </ParameterList>
              </ParameterList>
              <ParameterList name="DoF 3 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="0.0"/>
                </ParameterList>
              </ParameterList>
              <ParameterList name="DoF 4 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="0.0"/>
                </ParameterList>
              </ParameterList>
              <ParameterList name="DoF 5 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="0.0"/>
                </ParameterList>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
      </ParameterList>

    </ParameterList>
    

    <ParameterList name="VerboseObject">      
    </ParameterList>

  </ParameterList> <!-- End State -->
    


  <ParameterList name="Chemistry">
    
    <ParameterList name="Thermodynamic Database">
      <Parameter name="Format" type="string" value="simple" />
      <Parameter name="File" type="string" value="test/test_chemistry_pk.bgd" />
    </ParameterList> 
  

    <Parameter name="Number of component concentrations" type="int" value="5"/>
    <Parameter name="Component Solutes" type="Array(string)" value="{Al+++, H+, HPO4-, SiO2(aq), UO2++}"/>
    <Parameter name="Minerals" type="Array(string)" value="{Kaolinite, Quartz, (UO2)3(PO4)2.4H2O}"/>
    <Parameter name="Sorption Sites" type="Array(string)" value="{>FeOH, >AlOH, >SiOH}"/>

    <Parameter name="Verbosity" type="Array(string)" value="{verbose}"/>

    <Parameter name="Activity Model" type="string" value="debye-huckel"/>
    <Parameter name="Tolerance" type="double" value="1.50000000000000007e-12"/>
    <Parameter name="Maximum Newton Iterations" type="int" value="150"/>
    <Parameter name="Auxiliary Data" type="Array(string)" value="{pH}"/>


    <ParameterList name="initial conditions">
      <ParameterList name="free_ion_species">
        <ParameterList name="function">
          <ParameterList name="domain">
            <Parameter name="region" type="string" value="All"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <Parameter name="Number of DoFs" type="int" value="5"/>
              <Parameter name="Function type" type="string" value="composite function"/>
              <ParameterList name="DoF 1 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="4.36475999999999975e-16"/>
                </ParameterList>
              </ParameterList>
              <ParameterList name="DoF 2 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="3.16771999999999973e-08"/>
                </ParameterList>
              </ParameterList>
              <ParameterList name="DoF 3 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="9.99999999999999955e-07"/>
                </ParameterList>
              </ParameterList>
              <ParameterList name="DoF 4 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="1.86999999999999992e-04"/>
                </ParameterList>
              </ParameterList>
              <ParameterList name="DoF 5 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="1.84374000000000001e-20"/>
                </ParameterList>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
      </ParameterList>


      <ParameterList name="mineral_volume_fractions">
        <ParameterList name="function">
          <ParameterList name="domain">
            <Parameter name="region" type="string" value="All"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <Parameter name="Number of DoFs" type="int" value="3"/>
              <Parameter name="Function type" type="string" value="composite function"/>
              <ParameterList name="DoF 1 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="5.00000000000000028e-02"/>
                </ParameterList>
              </ParameterList>
              <ParameterList name="DoF 2 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="2.00000000000000011e-01"/>
                </ParameterList>
              </ParameterList>
              <ParameterList name="DoF 3 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="7.50000000000000000e-01"/>
                </ParameterList>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
      </ParameterList>

      <ParameterList name="mineral_specific_surface_area">
        <ParameterList name="function">
          <ParameterList name="domain">
            <Parameter name="region" type="string" value="All"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <Parameter name="Number of DoFs" type="int" value="3"/>
              <Parameter name="Function type" type="string" value="composite function"/>
              <ParameterList name="DoF 1 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="2.00000000000000010e-04"/>
                </ParameterList>
              </ParameterList>
              <ParameterList name="DoF 2 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="1.00000000000000005e-04"/>
                </ParameterList>
              </ParameterList>
              <ParameterList name="DoF 3 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="2.99999999999999989e-01"/>
                </ParameterList>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
      </ParameterList>


      <ParameterList name="sorption_sites">
        <ParameterList name="function">
          <ParameterList name="domain">
            <Parameter name="region" type="string" value="All"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <Parameter name="Number of DoFs" type="int" value="3"/>
              <Parameter name="Function type" type="string" value="composite function"/>
              <ParameterList name="DoF 1 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="5.36000000000000018e-03"/>
                </ParameterList>
              </ParameterList>
              <ParameterList name="DoF 2 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="6.36000000000000020e-03"/>
                </ParameterList>
              </ParameterList>
              <ParameterList name="DoF 3 Function">
                <ParameterList name="function-constant">
                  <Parameter name="value" type="double" value="4.36000000000000016e-03"/>
                </ParameterList>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
      </ParameterList>
    </ParameterList>
  </ParameterList> 
        

  <ParameterList name="Flow">
    <ParameterList name="Darcy problem">
      <Parameter name="relative permeability" type="string" value="upwind with gravity"/>
      <Parameter name="atmospheric pressure" type="double" value="0.0"/>
      
      <ParameterList name="operators">
        <ParameterList name="diffusion operator">
          <ParameterList name="matrix">
            <Parameter name="discretization primary" type="string" value="mfd: optimized for sparsity"/>
            <Parameter name="discretization secondary" type="string" value="mfd: optimized for sparsity"/>
            <Parameter name="schema" type="Array(string)" value="{face, cell}"/>
            <Parameter name="preconditioner schema" type="Array(string)" value="{face}"/>
            <Parameter name="gravity" type="bool" value="true"/>
          </ParameterList>
        </ParameterList>
      </ParameterList>

      <ParameterList name="steady state time integrator">
        <Parameter name="time integration method" type="string" value="BDF1"/>
        <Parameter name="preconditioner" type="string" value="Trilinos ML"/>
        <Parameter name="linear solver" type="string" value="AztecOO CG"/>
	
        <ParameterList name="BDF1">
          <Parameter name="error abs tol" type="double" value="0.1"/>
          <Parameter name="error rel tol" type="double" value="1e-5"/>
          <Parameter name="time step increase factor" type="double" value="1.0"/>
          <Parameter name="convergence tolerance" type="double" value="1e-12"/>
          <Parameter name="maximal number of iterations" type="int" value="200"/>
          <Parameter name="start time" type="double" value="0.0"/>
          <Parameter name="end time" type="double" value="100.0"/>
          <Parameter name="initial time step" type="double" value="0.1"/>
          <Parameter name="maximal time step" type="double" value="1.0"/>
          <Parameter name="time step increase factor" type="double" value="1.2"/>
        </ParameterList>
      </ParameterList>

      <ParameterList name="boundary conditions">
	<ParameterList name="pressure">
	  <ParameterList name="BC00">
	    <Parameter name="regions" type="Array(string)" value="{SS0}"/>
	    <ParameterList name="boundary pressure">
	      <ParameterList name="function-constant">
		<Parameter name="value" type="double" value="1.0"/>
	      </ParameterList>
	    </ParameterList>
	  </ParameterList>  
	  <ParameterList name="BC01">
	    <Parameter name="regions" type="Array(string)" value="{SS1}"/>
	    <ParameterList name="boundary pressure">
	      <ParameterList name="function-constant">
		<Parameter name="value" type="double" value="2.0"/>
	      </ParameterList>
	    </ParameterList>
	  </ParameterList>
	  <ParameterList name="BC03">
	    <Parameter name="regions" type="Array(string)" value="{SS3}"/>
	    <ParameterList name="boundary pressure">
	      <ParameterList name="function-constant">
		<Parameter name="value" type="double" value="-2.0"/>
	      </ParameterList>
	    </ParameterList>
	  </ParameterList>  
       </ParameterList>

	<ParameterList name="static head">
	  <ParameterList name="BC04">
	    <Parameter name="regions" type="Array(string)" value="{SS4}"/>
	    <ParameterList name="water table elevation">
	      <ParameterList name="function-constant">
		<Parameter name="value" type="double" value="2.0"/>
	      </ParameterList>
	    </ParameterList>
	  </ParameterList>
	</ParameterList>

	<ParameterList name="mass flux">
	  <ParameterList name="BC05">
	    <Parameter name="regions" type="Array(string)" value="{SS5}"/>
	    <ParameterList name="outward mass flux">
	      <ParameterList name="function-constant">
		<Parameter name="value" type="double" value="0.0"/>
	      </ParameterList>
	    </ParameterList>
	  </ParameterList>
	</ParameterList>  
      </ParameterList>
    </ParameterList> 
  </ParameterList>     


  <ParameterList name="Transport">
    <Parameter name="cfl" type="double" value="0.5"/>   
    <Parameter name="spatial discretization order" type="int" value="2"/>   
    <Parameter name="temporal discretization order" type="int" value="2"/>   
    <Parameter name="advection limiter" type="string" value="Tensorial"/>
    <!-- developers parameters --> 
    <Parameter name="enable internal tests" type="string" value="yes"/>   
    <Parameter name="internal tests tolerance" type="double" value="1e-5"/> 
    <!-- end of developers parameters -->

    <ParameterList name="VerboseObject">
      <Parameter name="Verbosity Level" type="string" value="medium"/>
    </ParameterList>
    
    <ParameterList name="boundary conditions">
      <ParameterList name="concentration">
        <ParameterList name="Component 0">
          <ParameterList name="BC for bottom and left side">
            <Parameter name="regions" type="Array(string)" value="{SS0}"/>
            <ParameterList name="boundary concentration">
              <ParameterList name="function-tabular">
                <Parameter name="forms" type="Array(string)" value="{constant}"/>
                <Parameter name="x values" type="Array(double)" value="{0.0, 0.1}"/>
                <Parameter name="y values" type="Array(double)" value="{1.0, 1.0}"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
      </ParameterList>
    </ParameterList>      
  </ParameterList>     


  <ParameterList name="Checkpoint Data">
    <Parameter name="file name base" type="string" value="restartdump"/>
    <Parameter name="file name digits" type="int" value="5"/>    
    <Parameter name="cycle start period stop" type="Array(double)" value="{0,1,10}"/>
  </ParameterList>

  <ParameterList name="Visualization Data">
    <Parameter name="file name base" type="string" value="visdump"/>
    <Parameter name="file name digits" type="int" value="5"/>    
    <Parameter name="cycle start period stop" type="Array(double)" value="{0,1,10}"/>
  </ParameterList>

</ParameterList> <!-- End Main -->
