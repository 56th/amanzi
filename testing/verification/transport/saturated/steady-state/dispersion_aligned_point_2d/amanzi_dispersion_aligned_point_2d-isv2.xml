<amanzi_input version="2.0.0" type="unstructured">

	<model_description name="Dispersion Example Problem">
		<comments>Example input file</comments>
		<model_id>Single-Phase Saturated</model_id>
       		<author>New input translation by VLF</author>
		<units>
	             <length_unit>m</length_unit>
	             <time_unit>s</time_unit>
	             <mass_unit>kg</mass_unit>
		     <conc_unit>molar</conc_unit>
		     </units>
	</model_description>

	<definitions>
		<macros>
			<time_macro name="Observation Times">
				<time>1.2096E+08</time>
			</time_macro>

			<time_macro name="EveryYear">
				<start>0.0</start>
				<timestep_interval>1.0E+07</timestep_interval>
				<stop>1.0E+09</stop>
			</time_macro>

			<cycle_macro name = "EveryCycle">
				<start>0</start>
				<timestep_interval>1</timestep_interval>
			</cycle_macro>
		</macros>
	</definitions>

	<process_kernels>
		<comments>Single phase flow only</comments>
		<flow state = "on" model = "saturated"/>
		<transport state = "on" algorithm="explicit first-order" sub_cycling = "on"/>
		<chemistry state = "off" process_model="none"/>
	</process_kernels>

	<phases>
		<liquid_phase name="water">
			<eos>false</eos>
			<viscosity>1.002E-03</viscosity>
			<density>998.2</density>

			<dissolved_components>
				<solutes>
					<solute coefficient_of_diffusion="1.0e-9">Tc-99</solute>
				</solutes>
			</dissolved_components>

		</liquid_phase>
	</phases>

	<execution_controls>
		<verbosity level="high"/>
		<execution_control_defaults mode="steady" method="picard"/>
		<execution_control  start="0.0" end="1.2096e+8" mode = "transient"/>
	</execution_controls>

	<numerical_controls>

		<linear_solver>
			<max_iterations>100</max_iterations>
			<tolerance>1e-20</tolerance>
			<cfl>1e-20</cfl>
		</linear_solver>
	</numerical_controls>


	<mesh framework="mstk"> 
		<comments>no comment</comments>
		<dimension>2</dimension>
		<generate>
			<number_of_cells nx = "84"  nz = "37"/>
			<box low_coordinates = "-271.0,-270.0" high_coordinates = "960.0,270.0"/>
		</generate>
	</mesh>

	<regions>
		<region name = "All">
			<box low_coordinates="-271.0,-270.0"  high_coordinates="960.0,270.0"/>
		</region>

		<region name = "Well">
			<box low_coordinates="-5.0,-5.0"  high_coordinates="5.0,5.0"/>
		</region>

		<point name = "Dnwind150"  coordinate="-150.0,0.0"/>
		<point name = "Dnwind090"  coordinate="-90.0,0.0"/>
		<point name = "Dnwind030"  coordinate="-30.0,0.0"/>
		<point name = "Upwind030"  coordinate="30.0,0.0"/>
		<point name = "Upwind090"  coordinate="90.0,0.0"/>
		<point name = "Upwind150"  coordinate="150.0,0.0"/>
		<point name = "Upwind210"  coordinate="210.0,0.0"/>
		<point name = "Upwind270"  coordinate="270.0,0.0"/>
		<point name = "Upwind330"  coordinate="330.0,0.0"/>
		<point name = "Upwind390"  coordinate="390.0,0.0"/>
		<point name = "Upwind450"  coordinate="450.0,0.0"/>

	</regions>



	<materials>
		<material name = "Aquifers">
			<mechanical_properties>
				<porosity value = "0.35"/>
				<dispersion_tensor alpha_l = "21.3" alpha_t = "4.3"/>
				<molecular_diffusion value = "0.0"/>
				<tortuosity value = "0.0"/>
			</mechanical_properties>
			<permeability x="1.0e-10" z="1.0e-10"/>
			<assigned_regions>All</assigned_regions>
		</material>
	</materials>

	<initial_conditions>
		<initial_condition name="All">
			<assigned_regions>All</assigned_regions>
			<liquid_phase name = "water">
	       		         <liquid_component name = "water">
					<velocity x = "1.8634e-06" z="1.8634e-06" function ="uniform"/>
	       		         	<uniform_pressure value = "101325"/>
				</liquid_component>    
				<solute_component name = "Tc-99" value = "0.0" function="uniform"/>
			</liquid_phase>
		</initial_condition>
	</initial_conditions>



	<sources>
		<source name ="SRC 1">
			<assigned_regions>Well</assigned_regions>
			<liquid_phase name="water">
				<solute_component name = "solute">
					<flow_weighted_conc name = "Tc-99" start = "0.0" function = "constant" value ="8.1483e-08"/>
					<flow_weighted_conc name = "Tc-99" start = "1.0e7" function = "constant" value ="0.0"/>
				</solute_component>
			</liquid_phase>
		</source>
	</sources>

	<output>
		<vis>
			<base_filename>plot</base_filename>
			<num_digits>5</num_digits>
			<time_macro>EveryYear</time_macro>
		</vis>

		<observations>
			<filename>obs5_2_1.out</filename>
			<liquid_phase name="water">
				<aqueous_conc solute="Tc-99">
					<assigned_regions>Dnwind150</assigned_regions>
					<functional>point</functional>
					<time_macro>Observation Times</time_macro>
				</aqueous_conc>
				<aqueous_conc solute="Tc-99">
					<assigned_regions>Dnwind090</assigned_regions>
					<functional>point</functional>
					<time_macro>Observation Times</time_macro>
				</aqueous_conc>
				<aqueous_conc solute="Tc-99">
					<assigned_regions>Dnwind030</assigned_regions>
					<functional>point</functional>
					<time_macro>Observation Times</time_macro>
				</aqueous_conc>
				<aqueous_conc solute="Tc-99">
					<assigned_regions>Upwind030</assigned_regions>
					<functional>point</functional>
					<time_macro>Observation Times</time_macro>
				</aqueous_conc>
				<aqueous_conc solute="Tc-99">
					<assigned_regions>Upwind090</assigned_regions>
					<functional>point</functional>
					<time_macro>Observation Times</time_macro>
				</aqueous_conc>
				<aqueous_conc solute="Tc-99">
					<assigned_regions>Upwind150</assigned_regions>
					<functional>point</functional>
					<time_macro>Observation Times</time_macro>
				</aqueous_conc>
				<aqueous_conc solute="Tc-99">
					<assigned_regions>Upwind270</assigned_regions>
					<functional>point</functional>
					<time_macro>Observation Times</time_macro>
				</aqueous_conc>
				<aqueous_conc solute="Tc-99">
					<assigned_regions>Upwind330</assigned_regions>
					<functional>point</functional>
					<time_macro>Observation Times</time_macro>
				</aqueous_conc>
				<aqueous_conc solute="Tc-99">
					<assigned_regions>Upwind390</assigned_regions>
					<functional>point</functional>
					<time_macro>Observation Times</time_macro>
				</aqueous_conc>
				<aqueous_conc solute="Tc-99">
					<assigned_regions>Upwind450</assigned_regions>
					<functional>point</functional>
					<time_macro>Observation Times</time_macro>
				</aqueous_conc>
			</liquid_phase>
		</observations>

	</output>

</amanzi_input>


