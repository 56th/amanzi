<amanzi_input version="2.0.0" type="unstructured">

  <model_description name="SR Test Problem">

    <comments>Confind aquifer transient drawdown (Theis 1935)</comments>
    <model_id>Theis</model_id>
    <author>Dylan Harp, Alec Thomas, David Moulton</author>
    <units>
      <length_unit>m</length_unit>
      <time_unit>s</time_unit>
      <mass_unit>kg</mass_unit>
      <conc_unit>molar</conc_unit>
    </units>

  </model_description>
  
  <!--

    Macro Definitions

  -->
  <definitions>

    <macros>
      <time_macro name="Observation Times">
	<time>0.0</time>
        <time>0.0864</time>
        <time>0.4</time>
        <time>400</time>
        <time>500</time>
        <time>600</time>
        <time>5000</time>
        <time>8000</time>
        <time>10000</time>
        <time>28000</time>
        <time>35000</time>
        <time>43000</time>
        <time>81000</time>
        <time>90000</time>
        <time>100000</time>
        <time>164000</time>
      </time_macro>
    </macros>	

  </definitions>

  <!--

    Process Kernels

  -->
  <process_kernels>
    <comments>Single-phase transient flow</comments>
    <flow state = "on" model = "saturated"/>
    <transport state = "off" algorithm = "none"/>
    <chemistry state = "off" process_model="none"/>
  </process_kernels>
  

  <!--

    Execution Control

  -->
  <execution_controls>
    <verbosity level="high"/>
    <execution_control_defaults init_dt= "3.64" increase_factor="1.1" method="bdf1"/>
    <execution_control start="0.0" end="1.64e5" init_dt="3.64" mode="transient"/>
  </execution_controls>

  <!--

    Numerical Control Parameters

  -->
  <numerical_controls>
    <linear_solver>
      <max_iterations>1000</max_iterations>
      <tolerance>1.0e-16</tolerance>
    </linear_solver>
  </numerical_controls>
  
  <!--

    Mesh

  -->
  <mesh framework="mstk">
    <comments>Three-dimensional box 100m x 50m x 50m</comments>
    <dimension>3</dimension>
    <generate>
      <number_of_cells nx="600"  ny="600"  nz="1"/>
      <box  low_coordinates="-1200.0,-1200.0,0.0"  high_coordinates="1200.0,1200.0,10.0"/>
    </generate>
  </mesh>

  <!--

    Output

  -->
  <regions>

    <region name ="Entire Domain">
      <comments>One region covering the entire domain</comments>
      <box  low_coordinates="-1200.0,-1200.0,0.0"  high_coordinates="1200.0,1200.0,10.0"/>
    </region>

    <region name ="Well">
     <comments>Pumping Well</comments>
      <box low_coordinates= "-2.0,-2.0,0.0" high_coordinates="2.0,2.0,10.0"/>
    </region>

    <plane name="yz1" location="-1200.0,-1200.0,0.0" normal="-1.0,0.0,0.0"/>
    <plane name="yz2" location="1200.0,-1200.0,0.0" normal="1.0,0.0,0.0"/>
    <plane name="xz1" location="-1200.0,-1200.0,0.0" normal="0.0,-1.0,0.0"/>
    <plane name="xz2" location="-1200.0,1200.0,0.0" normal="0.0,1.0,0.0"/>

    <point name="Obs_r1" coordinate="(-33.0,0.0,5.0)"/>
    <point name="Obs_r2" coordinate="(-55.0,0.0,5.0)"/>
    <point name="Obs_r3" coordinate="(-161.0,0.0,5.0)"/>

  </regions>
  

  <!--

    Phases

  -->
  <phases>
    <liquid_phase name="water">
      <eos>false</eos>
      <viscosity>1.002E-03</viscosity>
      <density>1000.0</density>
    </liquid_phase>
  </phases>

  <!--

    Materials

  -->
  <materials>

    <material name="Soil">
      <comments>Homogeneous material properties throughout the entire domain</comments>
      <assigned_regions>Entire Domain</assigned_regions>
      <mechanical_properties>
        <porosity value="0.25"/>
	<specific_storage value="7.5e-5"/>
      </mechanical_properties>
      <permeability x="2.35E-11" y="2.35E-11" z="2.35E-11"/>
    </material>

  </materials>

  <!--

    Initial Conditions

  -->
  <initial_conditions>

    <initial_condition name="Initial Condition">
      <comments>Hydrostatic pressure with a water-table height of 20.0m</comments>
      <assigned_regions>Entire Domain</assigned_regions>
      <liquid_phase name = "water">
	<liquid_component name = "water">
	  <linear_pressure value = "101325" function="linear" reference_coord ="(1200.0,1200.0,20.0)" gradient="(0.0,0.0,-9806.65)"/>
	</liquid_component>
      </liquid_phase>
    </initial_condition>

  </initial_conditions>
	

  <!--

    Boundary Conditions

  -->
  <boundary_conditions>

    <boundary_condition name = "Far Field Head">
      <comments>Far field static head of the confined aquifer</comments>
      <assigned_regions>xz1,xz2,yz2,yz2</assigned_regions>
      <liquid_phase name = "water">
	<liquid_component name = "water">
	  <hydrostatic start="0.0" function= "constant" value="20.0"/>
	</liquid_component>
      </liquid_phase>
    </boundary_condition>

  </boundary_conditions>

  <sources>
    <source name = "Pumping Well" >
      <assigned_regions>Well</assigned_regions>
      <liquid_phase name = "water">
	<liquid_component name="water">
	  <volume_weighted start="0.0" function="constant" value="-4.0"/>
	</liquid_component>
      </liquid_phase>
    </source>
  </sources>
  <!--

    Output

  -->
  <output>
    
    <observations>

      <filename>observation.out</filename>

      <liquid_phase name="water">
	<aqueous_pressure>
	  <assigned_regions>Obs_r1</assigned_regions>
	  <functional>point</functional>
	  <time_macro>Observation Times</time_macro>
	</aqueous_pressure>
	<aqueous_pressure>
	  <assigned_regions>Obs_r2</assigned_regions>
	  <functional>point</functional>
	  <time_macro>Observation Times</time_macro>
	</aqueous_pressure>
	<aqueous_pressure>
	  <assigned_regions>Obs_r2</assigned_regions>
	  <functional>point</functional>
	  <time_macro>Observation Times</time_macro>
	</aqueous_pressure>
      </liquid_phase>

    </observations>
    
  </output>

</amanzi_input>

